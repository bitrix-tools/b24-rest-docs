# MCP-сервер для работы с REST API Битрикс24

Когда разработчик просит AI-ассистента в среде разработки написать код для интеграции с Битрикс24, нейросеть может предложить несуществующие методы или передать лишние параметры. MCP дает ассистенту прямой доступ к актуальной документации, поэтому ответы становятся точнее.

## Что такое MCP

MCP (Model Context Provider) — это сервер, который передает AI-ассистенту структурированные данные: описания методов, списки параметров, допустимые значения и подсказки по использованию.

MCP позволяет:

- получать актуальные методы и поля API под конкретную задачу,

- работать со структурированными данными вместо свободного текста,

- сокращать количество ошибок и правок кода.

## Как подключить MCP-сервер

Укажите адрес сервера <https://mcp-dev.bitrix24.tech/mcp> в настройках среды разработки.

Сервер доступен без авторизации.

### Cursor

1. Откройте *File > Preferences > Cursor Settings > Tools & MCP > New MCP server*. Cursor откроет системный файл `mcp.json`. 

2. Добавьте конфигурацию через создание нового элемент массива `mcpServers` в файле `mcp.json`:

  ```json
  {
  "mcpServers": {
      "b24-dev-mcp": {
      "url": "https://mcp-dev.bitrix24.tech/mcp",
      "timeout": 30000
      }
  }
  }
  ```

3. Сохраните файл. На странице *File > Preferences > Cursor Settings > Tools & MCP* рядом с сервером появится зеленый индикатор и список доступных инструментов.

4. При составлении запроса добавьте файл `mcp.json` в контекст.

Альтернативный способ добавления MCP:

```html
<a href="https://cursor.com/en-US/install-mcp?name=b24-dev-mcp&config=eyJ1cmwiOiJodHRwczovL21jcC1kZXYuYml0cml4MjQuY29tL21jcCIsInRpbWVvdXQiOjMwMDAwfQ%3D%3D"><img src="https://cursor.com/deeplink/mcp-install-dark.svg" alt="Add b24-dev-mcp MCP server to Cursor" height="32" /></a>
```

### GitHub Copilot Chat, VS Code

1. Для настройки используйте инструкцию [GitHub](https://docs.github.com/ru/copilot/how-tos/provide-context/use-mcp/extend-copilot-chat-with-mcp#configuring-mcp-servers-manually).

2. Создайте файл `.vscode/mcp.json` в корне проекта. Содержимое файла:

  ```json
  {
    "servers": {
      "b24-dev-mcp": {
        "url": "https://mcp-dev.bitrix24.tech/mcp",
        "type": "http"
      }
    },
    "inputs": []
  }
  ```

3. Запустите MCP-агент кнопкой `Start`, которая появится в файле `.vscode/mcp.json`.

4. Выберите настроенный MCP-агент в чате. Copilot будет запрашивать контекст у MCP при генерации кода.

### Claude Desktop, Anthropic

1. Перейдите в *Settings > Connectors*.

2. Нажмите `Add custom connector`.

3. Заполните поля:

   - `Name`: `b24-dev-mcp`;

   - `URL`: `https://mcp-dev.bitrix24.tech/mcp`.

4. Сохраните настройки. Claude автоматически определяет, когда стоит использовать MCP.

### Gemini Code Assist CLI

1. Добавьте MCP-сервер командой:

  ```bash
  gemini mcp add --transport http b24-dev-mcp https://mcp-dev.bitrix24.tech/mcp
  ```

2. Проверьте, что сервер появился в списке, командой `gemini mcp list`. Gemini автоматически определяет, когда стоит использовать MCP.

### Google Antigravity

1. Откройте меню **MCP Store**, нажав на «...» в верхней части панели агента.

2. Нажмите **Manage MCP Servers**.

3. Выберите **View raw config**.

4. Добавьте в открывшийся файл `mcp_config.json` настройки подключения:

   ```json
   {
     "mcpServers": {
       "b24-dev-mcp": {
            "serverUrl": "https://mcp-dev.bitrix24.tech/mcp"
        }
     }
   }
   ```

5. Сохраните изменения. 

## Примеры запросов

MCP-сервер автоматически предоставляет ассистенту актуальные данные REST API Битрикс24, но способы взаимодействия между средой разработки и MCP различаются.

### Cursor

**Особенность**: необходимо подключить MCP конфигурацию в контекст чата.

1. Добавьте файл `mcp.json` в контекст чата.

2. Отправьте запрос в чат с AI-ассистентом — «Напиши `curl`-запрос для создания лида в Битрикс24.»

3. Ассистент обратится к MCP-серверу.

4. MCP вернет информацию о методе и его параметрах из документации.

5. Ассистент сгенерирует код на основе ответа MCP.

### GitHub Copilot Chat, VS Code

**Особенность**: необходимо выбрать MCP в качестве агента для выполнения запроса.

1. Выберите MCP-агент и отправьте запрос в чат с AI-ассистентом — «Создай лид в Битрикс24 с контактной информацией и источником "веб-сайт". Покажи пример на JavaScript.»

2. Copilot автоматически использует выбранный MCP-агент.

3. MCP вернет информацию о методе и его параметрах из документации.

4. Ассистент сгенерирует код на основе ответа MCP.

### Claude Desktop, Anthropic

**Особенность**: автоматическое определение необходимости использовать MCP.

1. Отправьте запрос в чат с AI-ассистентом — «Напиши запрос для создания нового лида в Битрикс24. В лид будут переданы данные: имя, компания и телефон».

2. Claude сам определит, что нужны данные из подключенного MCP и отправит запрос.

3. MCP вернет информацию о методе и его параметрах из документации.

4. Ассистент сгенерирует код на основе ответа MCP.

### Gemini Code Assist CLI

**Особенность**: автоматическое определение необходимости использовать MCP.

1. Выполните команду `gemini chat` и отправьте запрос — «Собери `curl`-запрос для создания лида с полями имя, телефон и источником «сайт».

2. Gemini сам определит, что нужны данные из подключенного MCP и отправит запрос.

3. MCP вернет описание подходящего метода и его параметры из документации.

4. Gemini сгенерирует код на основе ответа MCP.

### Google Antigravity

**Особенность**: автоматическое определение необходимости использовать MCP.

1. Отправьте запрос в чат — «Найди метод для обновления сделки в CRM».

2. Antigravity определит, что нужны данные из MCP, выполнит поиск и вернет результат.

3. Ассистент сгенерирует ответ с учетом документации.
