# Сделать то-то (краткая суть операции метода)

> Название метода: **crm.xxx**
>
> Scope: [`crm`](../scopes/permissions.md)
>
> Кто может выполнять метод: администратор / любой пользователь

Метод делает вот это

## Параметры метода

{% include [Сноска об обязательных параметрах](../../_includes/required.md) %}

#|
|| **Название**
`тип` | **Описание** ||
|| **CODE***
[`string`](../../_includes/data-types.md) | Описание параметра. Тип ссылается на страницу со стандартными типами данных ||
|| **NAME***
[`crm_item`](data-types.md) | Описание параметра. Тип ссылается на страницу со типами данных текущего скоупа ||
|| **SETTINGS***
[`array`](../../data-types.md) | Пример параметра, имеющего сложную вложенную структуру. На текущем уровне мы описываем её в целом, но без всех подробностей - просто даём представление в целом. Потому что потом, отдельные ключи вроде CONFIG или ITEMS мы будем описывать в последующих таблицах с отдельными подзаголовками

```json
{
    "PRINT_URL": "значение",
    "CHECK_URL": "значение",
    "HTTP_VERSION": "значение",
    "CONFIG":
    {
        "ключ раздела 1": {
            "LABEL": "название раздела 1",
            "ITEMS": {
                "настройка 1-1": {
                    "TYPE": "значение",
                    "LABEL": "значение"
                    ...
                },
                ...
                "настройка 1-N": {
                    ...
                }
            }
        },
        ...
        "ключ раздела N": {
            "LABEL": "название раздела N",
            "ITEMS": {
                ...
            }
        }
    }
}
```

 ||
|#

### Параметр SETTINGS

{% include [Сноска об обязательных параметрах](../../_includes/required.md) %}

#|
|| **Название**
`тип` | **Описание** ||
|| **PRINT_URL***
[`string`](../../data-types.md) | Описание параметра. Тип ссылается на страницу со стандартными типами данных  ||
|| **HTTP_VERSION***
[`http_status`](data-types.md) | Описание параметра. Тип ссылается на страницу со типами данных текущего скоупа ||
|| **CONFIG***
[`array`](../../data-types.md) | Описание параметра со сложной структурой. В продолжение предыдущей таблицы. Опять же, даём общее представление, зная, что подброности об ITEMS будут ниже (в болванке уже не будем приводить ITEMS, принцип понятен)

```json
"ключ раздела 1": {
    "LABEL": "название раздела 1",
    "ITEMS": {
        "настройка 1-1": {
            ...
        },
        ... 
    }
},
...
"ключ раздела N": {
    ...
}
```

||
|| **TYPE***
[`string`](../../data-types.md) | Описание параметра в виде списка значений (та же история про поля с `Y`/`N`). Возможные значения:

- `STRING` — строка
- `NUMBER` — число с плавающей точкой
- `Y/N` — строка, принимающая значения `Y` или `N`
- `ENUM` — список строковых значений
- `DATE` — дата

Значение по умолчанию: `STRING`
||
|#

## Примеры кода

{% include [Сноска о примерах](../../../_includes/examples.md) %}

{% list tabs %}

- cURL (Webhook)

    сюда мы сами вставим нужный код, перегенерированный из вашего примера на JS

- cURL (OAuth)

    сюда мы сами вставим нужный код, перегенерированный из вашего примера на JS

- JS

    ```js
    BX24.callMethod(
        "sale.cashbox.handler.add",
        {
            "CODE": "restcashbox01",
            "NAME": "REST-касса 01",
            "SORT": 100,
            "SUPPORTS_FFD105": "Y",
            "SETTINGS":
            {
                "PRINT_URL": "http://example.com/rest_print.php",
                "CHECK_URL": "http://example.com/rest_check.php",
                "HTTP_VERSION": "1.1",
                "CONFIG":
                {
                    "AUTH": {
                        "LABEL": "Авторизация",
                        "ITEMS": {
                            "KEYWORD": {
                                "TYPE": "STRING",
                                "LABEL": "Кодовое слово"
                            },
                            "PREFERENCE": {
                                "TYPE": "ENUM",
                                "LABEL": "Множественный выбор",
                                "REQUIRED": "Y",
                                "OPTIONS": {
                                    "FIRST": "Первый",
                                    "SECOND": "Второй",
                                    "THIRD": "Третий",
                                }
                            }
                        }
                    },
                    "INTERACTION": {
                        "LABEL": "Настройки взаимодействия с кассой",
                        "ITEMS": {
                            "MODE": {
                                "TYPE": "ENUM",
                                "LABEL": "Режим работы с кассой",
                                "OPTIONS": {
                                    "ACTIVE": "боевой",
                                    "TEST": "тестовый"
                                }
                            }
                        }
                    }
                }
            }
        },
        function(result)
        {
            if(result.error())
                console.error(result.error());
            else
                console.dir(result.data());
        }
    );
    ```

- PHP

    сюда мы сами вставим нужный код, перегенерированный из вашего примера на JS

{% endlist %}

{% note tip "Частые кейсы и сценарии" %}

Контент этого блока мы сами заполним потом. Или уберем блок за ненадобностью

{% endnote %}

## Обработка ответа

HTTP-статус: **200**

```json
{
    "result": 5,
    "time": {
        "start": 1712132792.910734,
        "finish": 1712132793.530359,
        "duration": 0.6196250915527344,
        "processing": 0.032338857650756836,
        "date_start": "2024-04-03T10:26:32+02:00",
        "date_finish": "2024-04-03T10:26:33+02:00",
        "operating_reset_at": 1705765533,
        "operating": 3.3076241016387939
    }
}
```

### Возвращаемые данные

#|
|| **Название**
`тип` | **Описание** ||
|| **result**
[`integer`](../../data-types.md) | Описание возвращаемого значения. Ссылка либо на корневой справочник типов, либо на типы данных внутри скоупа ||
|| **time**
[`array`](../../data-types.md) | Информация о времени выполнения запроса ||
|| **start**
[`double`](../../data-types.md) | Timestamp момента инициализации запроса ||
|| **finish**
[`double`](../../data-types.md) | Timestamp момента завершения выполнения запроса ||
|| **duration**
[`double`](../../data-types.md) | Как долго в миллисекундах выполнялся запрос (finish — start) ||
|| **date_start**
[`string`](../../data-types.md) | Строковое представление даты и времени момента инициализации запроса ||
|| **date_finish**
[`double`](../../data-types.md) | Строковое представление даты и времени момента завершения запроса ||
|| **operating_reset_at**
[`timestamp`](../../data-types.md) | Timestamp момента, когда будет сброшен лимит на ресурсы REST API. Читайте подробности в статье [лимит на операции](../../../limits.md) ||
|| **operating**
[`double`](../../data-types.md) | Через сколько миллисекунд будет сброшен лимит на ресурсы REST API. Читайте подробности в статье [лимит на операции](../../../limits.md) ||
|#

## Обработка ошибок

HTTP-статус: **400**

```json
{
    "error": "ERROR_HANDLER_ALREADY_EXIST",
    "error_description": "Handler already exists!"
}
```

{% include notitle [обработка ошибок](../../../_includes/error-info.md) %}

### Возможные коды ошибок

#|
|| **Код** | **Описание** ||
|| `ERROR_CHECK_FAILURE` | Либо не указано значение обязательного поля, либо значение одного из полей указано неверно ||
|| `ERROR_HANDLER_ALREADY_EXIST` | Обработчик с кодом, указанным в параметре `CODE`, уже существует в системе ||
|#

{% include [системные ошибки](../../../_includes/system-errors.md) %}

## Продолжите изучение

Этот блок мы сами потом заполним, но если есть рекомендации, какие методы или страницы документации тут стоит упомянять - будем благодарны
