# На изменение сообщения ONIMBOTMESSAGEUPDATE

{% note warning "Мы еще обновляем эту страницу" %}

Тут может не хватать некоторых данных — дополним в ближайшее время

{% endnote %}

{% if build == 'dev' %}

{% note alert "TO-DO _не выгружается на prod_" %}

- нужны правки под стандарт написания
- не указаны типы параметров
- не указана обязательность параметров
- таблицы параметров сгенерированы по примеру. Что такое [39] в примере??? BOT_ID? И как это записать в таблицу?

{% endnote %}

{% endif %}

> Scope: [`imbot`](../../../scopes/permissions.md)
>
> Кто может подписаться: любой пользователь

Событие `ONIMBOTMESSAGEUPDATE`, возникающее при редактировании сообщения.

{% note warning %}

Описанные ниже поля - это содержимое поля [data] в событии. Данные авторизации в ключе [auth] содержат данные пользователя инициатора события, для получения данных авторизации бота, необходимо использовать [data][BOT][__BOT_CODE__].

{% endnote %}

#|
|| **Поле** | **Описание** | **Ревизия** ||
|| **BOT** 
[`unknown`](../../../data-types.md) | Массив кодов чат-ботов, которым предназначено сообщение | ||
|| **PARAMS** 
[`unknown`](../../../data-types.md) | Массив данных сообщения | ||
|| **USER** 
[`unknown`](../../../data-types.md) | Массив данных автора сообщения, может быть пустым, если ID = 0 | ||
|#

## BOT/[39]???

#|
|| **Поле** | **Описание** | **Ревизия** ||
|| **AUTH** 
[`unknown`](../../../data-types.md) | Параметры для авторизации под ботом, для выполнения действий | ||
|| **BOT_ID** 
[`unknown`](../../../data-types.md) | Идентификатор бота | ||
|| **BOT_CODE** 
[`unknown`](../../../data-types.md) | Код бота | ||
|#

## AUTH

#|
|| **Поле** | **Описание** | **Ревизия** ||
|| **domain** 
[`unknown`](../../../data-types.md) | Домен | ||
|| **member_id** 
[`unknown`](../../../data-types.md) | Уникальный идентификатор | ||
|| **application_token** 
[`unknown`](../../../data-types.md) | Токен приложения | ||
|#

## PARAMS

#|
|| **Поле** | **Описание** | **Ревизия** ||
|| **DIALOG_ID** 
[`unknown`](../../../data-types.md) | Идентификатор диалога | ||
|| **CHAT_TYPE** 
[`unknown`](../../../data-types.md) | Тип сообщения и чата, может быть P (чат один-на-один), C (с ограниченным количеством участников), O (публичный чат), S (чат-бот с повышенными привилегиями - supervisor) | ||
|| **CHAT_ENTITY_TYPE** 
[`unknown`](../../../data-types.md) | для идентификации чата (данные поле вы можете задать в момент создания), для чатов открытых линий в данном поле будет указано LINES | ||
|| **CHAT_ENTITY_ID** 
[`unknown`](../../../data-types.md) | для идентификации чата (данные поле вы можете задать в момент создания) | ||
|| **MESSAGE_ID** 
[`unknown`](../../../data-types.md) | Идентификатор сообщения | ||
|| **MESSAGE** 
[`unknown`](../../../data-types.md) | Сообщение | ||
|| **MESSAGE_ORIGINAL** 
[`unknown`](../../../data-types.md) | Оригинальное сообщение с BB-кодом чат-бота (параметр доступен только в групповых чатах) | ||
|| **FROM_USER_ID** 
[`unknown`](../../../data-types.md) | Идентификатор пользователя отправившего сообщение | ||
|| **TO_USER_ID** 
[`unknown`](../../../data-types.md) | Идентификатор бота или пользователя: в диалоге "один-на-один" это будет идентификатор бота, а в групповом чате - идентификатор пользователя, кому направлено обращение. Если указано 0 - значит всем участникам чата | ||
|| **TO_CHAT_ID** 
[`unknown`](../../../data-types.md) | Идентификатор чата (параметр доступен только в групповых чатах) | ||
|| **LANGUAGE** 
[`unknown`](../../../data-types.md) | Идентификатор языка портала по умолчанию | ||
|#

## USER

#|
|| **Поле** | **Описание** | **Ревизия** ||
|| **ID** 
[`unknown`](../../../data-types.md) | Идентификатор пользователя | ||
|| **NAME** 
[`unknown`](../../../data-types.md) | Имя и фамилия пользователя | ||
|| **FIRST_NAME** 
[`unknown`](../../../data-types.md) | Имя пользователя | ||
|| **LAST_NAME** 
[`unknown`](../../../data-types.md) | Фамилия пользователя | ||
|| **WORK_POSITION** 
[`unknown`](../../../data-types.md) | Занимаемая должность | ||
|| **GENDER** 
[`unknown`](../../../data-types.md) | Пол, может быть либо M (мужской), либо F (женский) | ||
|| **IS_BOT** 
[`unknown`](../../../data-types.md) | Это пользователь - бот (Y), иначе - N. | ||
|| **IS_CONNECTOR** 
[`unknown`](../../../data-types.md) | Это пользователь - коннектор (участник ОЛ-чата, клиент), иначе - N. | ||
|| **IS_NETWORK** 
[`unknown`](../../../data-types.md) | Это пользователь нетворка (может быть участником ОЛ-чата, клиент или просто внешний пользователь), иначе - N. | ||
|| **IS_EXTRANET** 
[`unknown`](../../../data-types.md) | Это пользователь экстранет (все пользователи, которые не-интранет), иначе - N. | ||
|#

## Примеры

{% list tabs %}

- JS

    ```js
    [BOT] => Array (
        [39] => Array (
            [AUTH] => Array (
                [domain] => b24.hazz
                [member_id] => d41d8cd98f00b204e9800998ecf8427e
                [application_token] => 8006ddd764e69deb28af0c768b10ed65
            )
            [BOT_ID] => 39    
            [BOT_CODE] => newbot
        )
    )
    [PARAMS] => Array (
        [DIALOG_ID] => 1    
        [CHAT_TYPE] => P    
        [CHAT_ENTITY_TYPE] => 'LINES'    
        [CHAT_ENTITY_ID] => 13    
        [MESSAGE_ID] => 392
        [MESSAGE] => test3
        [MESSAGE_ORIGINAL] => [USER=39]NewBot[/USER] test3
        [FROM_USER_ID] => 1
        [TO_USER_ID] => 1
        [TO_CHAT_ID] => 6
        [LANGUAGE] => ru    
    )
    [USER] => Array (
        [ID] => 1
        [NAME] => Евгений Шеленков
        [FIRST_NAME] => Евгений
        [LAST_NAME] => Шеленков
        [WORK_POSITION] =>
        [GENDER] => M
        [IS_BOT] => 'Y'
        [IS_CONNECTOR] => 'Y'
        [IS_NETWORK] => 'Y'
        [IS_EXTRANET] => 'Y'
    )
    ```

{% endlist %}

{% include [Сноска о примерах](../../../../_includes/examples.md) %}