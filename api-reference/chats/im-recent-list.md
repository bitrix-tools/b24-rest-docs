# Получить список чатов im.recent.list

{% note warning "Мы еще обновляем эту страницу" %}

Тут может не хватать некоторых данных — дополним в ближайшее время

{% endnote %}

{% if build == 'dev' %}

{% note alert "TO-DO _не выгружается на prod_" %}

- нужны правки под стандарт написания
- не указаны типы параметров
- отсутствуют примеры
- отсутствует ответ в случае ошибки

{% endnote %}

{% endif %}

> Scope: [`im`](../scopes/permissions.md)
>
> Кто может выполнять метод: любой пользователь

Метод `im.recent.list` получает список последних диалогов пользователя (с поддержкой пагинации).

#|
|| **Параметр** | **Пример** | **Описание** | **Ревизия** ||
|| **SKIP_OPENLINES**
[`unknown`](../data-types.md) | `'Y'` | Пропускать чаты открытых линий | 30 ||
|| **SKIP_DIALOG**
[`unknown`](../data-types.md) | `'N'` | Пропускать диалоги "один на один" | 30 ||
|| **SKIP_CHAT**
[`unknown`](../data-types.md) | `'Y'` | Пропускать чаты | 30 ||
|| **LAST_MESSAGE_DATE**
[`unknown`](../data-types.md) | `'2021-10-30'` | Дата из последнего элемента предыдущей выборки | 30 ||
|#

## Примеры

{% list tabs %}

- JS

   ```js
   B24.callMethod(
      'im.recent.list',
      {
         LAST_MESSAGE_DATE: '2021-10-30'
      },
      res => {
         if (res.error())
         {
               console.error(result.error().ex);
         }
         else
         {
               console.log(res.data())
         }
      }
   )
   ```

{% endlist %}

{% include [Сноска о примерах](../../_includes/examples.md) %}

## Ответ в случае успеха

```json
{
"items": [
    {
     "id": "chat71",
     "chat_id": 71,
     "type": "chat",
     "avatar": {
        "url": "",
        "color": "#8474c8"
     },
     "title": "Фиолетовый гость №3 - Открытая линия 2",
     "message": {
        "id": 267,
        "text": "Отправлена форма \"Форма контактных данных для открытых линий\" [Вложение]",
        "file": false,
        "author_id": 0,
        "attach": true,
        "date": "2021-10-27T18:20:45+02:00",
        "status": "received"
     },
     "counter": 3,
     "pinned": false,
     "unread": false,
     "date_update": "2021-10-27T18:20:45+02:00",
     "chat": {
        "id": 71,
        "name": "Фиолетовый гость №3 - Открытая линия 2",
        "owner": 0,
        "extranet": false,
        "avatar": "",
        "color": "#8474c8",
        "type": "lines",
        "entity_type": "LINES",
        "entity_id": "livechat|2|70|2016",
        "entity_data_1": "N|NONE|0|N|N|7|1635351612|0|0|0",
        "entity_data_2": "",
        "entity_data_3": "",
        "mute_list": [],
        "manager_list": [],
        "date_create": "2021-10-27T18:20:12+02:00",
        "message_type": "L"
     },
     "lines": {
        "id": 7,
        "status": 5,
        "date_create": "2021-10-27T18:20:12+02:00"
     },
     "user": {
        "id": 0
     },
     "options": []
    },
    ...
],
"hasMore": false
}
```

### Описание ключей

- `id` – идентификатор диалога (если цифра – это пользователь; если **chatXXX** – это чат)
- `type` – тип записи (если **user** – это пользователь, если **chat** – это чат)
- `avatar` – объект описания аватара записи:
  - `url` – ссылка на аватар (если пусто, значит, аватар не задан)
  - `color` – цвет диалога в формате **hex**
- `title` – заголовок записи (имя и фамилия – для пользователя, название чата – для чата)
- `messages` – объект описания сообщения:
  - `id` – идентификатор сообщения
  - `text` – текст сообщения (без BB-кодов и переносов строк)
  - `file` – присутствуют файлы (**true/false**)
  - `attach` – присутствуют вложения (**true/false**)
  - `author_id` – автор сообщения
  - `date` – дата сообщения
- `counter` – счетчик непрочитанных сообщений
- `user` – объект описания данных пользователя (не доступно, если это тип записи – чат):
  - `id` – идентификатор пользователя
  - `name` – имя и фамилия пользователя
  - `first_name` – имя пользователя
  - `last_name` – фамилия пользователя
  - `work_position` – должность
  - `color` – цвет пользователя в формате **hex**
  - `avatar` – ссылка на аватар (если пусто, значит, аватар не задан)
  - `gender` – пол пользователя
  - `birthday` – день рождения пользователя в формате **DD-MM**, если пусто – не задан
  - `extranet` – признак внешнего экстранет-пользователя (**true/false**)
  - `network` – признак пользователя **Битрикс24.Network** (**true/false**)
  - `bot` – признак бота (**true/false**)
  - `connector` – признак пользователя открытых линий (**true/false**)
  - `external_auth_id` – код внешней авторизации
  - `status` – выбранный статус пользователя
  - `idle` – дата, когда пользователь отошел от компьютера, в формате **АТОМ** (если не задано, то **false**)
  - `last_activity_date` – дата последнего действия пользователя в формате **АТОМ**
  - `mobile_last_date` – дата последнего действия в мобильном приложении в формате **АТОМ** (если не задано, то **false**)
  - `absent` – дата, по какое число у пользователя отпуск, в формате **АТОМ** (если не задано, то **false**)
- `chat` – объект описания данных чата (не доступно, если это тип записи – пользователь):
  - `id` – идентификатор чата
  - `title` – название чата
  - `owner` – идентификатор пользователя-владельца чата
  - `extranet` – признак участия в чате внешнего экстранет-пользователя (**true/false**)
  - `color` – цвет чата в формате **hex**
  - `avatar` – ссылка на аватар (если пусто, значит, аватар не задан)
  - `type` – тип чата (групповой чат, чат для звонка, чат открытой линии и т.д.)
  - `entity_type` – внешний код для чата – тип
  - `entity_id` – внешний код для чата – идентификатор
  - `entity_data_1` – внешние данные для чата
  - `entity_data_2` – внешние данные для чата
  - `entity_data_3` – внешние данные для чата
  - `date_create` – дата создания чата в формате **АТОМ**
  - `message_type` – тип сообщений чата
- `pinned` – закреплен чат или нет
- `unread` – стоит ли ручная метка о том, что чат не прочитан
- `date_update` – дата последнего изменения в связанных сущностях