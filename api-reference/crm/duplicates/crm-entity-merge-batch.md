# Объединить дубликаты crm.entity.mergeBatch

{% note warning "Мы еще обновляем эту страницу" %}

Тут может не хватать некоторых данных — дополним в ближайшее время

{% endnote %}

{% if build == 'dev' %}

{% note alert "TO-DO _не выгружается на prod_" %}

- отсутствуют примеры (на других языках)
- отсутствует ответ в случае успеха
- отсутствует ответ в случае ошибки
- не указана обязательность параметров

{% endnote %}

{% endif %}

> Scope: [`crm`](../../scopes/permissions.md)
>
> Кто может выполнять метод: любой пользователь

```http
crm.entity.mergeBatch({params: {entityTypeId: number, entityIds: number[]}})
```
`params` - ассоциативный массив, содержащий ключи:

#|
|| **Ключ** | **Описание** ||
|| **entityTypeId**
| Идентификатор типа сущности. Может принимать значения `1` (лид), `2` (сделка), `3` (контакт) или `4` (компания) ||
|| **entityIds** 
| Массив идентификаторов элементов, которые необходимо объединить ||
|#

Метод вернет ассоциативный массив вида:

```json
{
    "STATUS": "SUCCESS",
    "ENTITY_IDS": [
        "1"
    ]
}
```

Здесь:

#|
|| **Параметр** | **Описание** ||
|| **STATUS**
| Может принимать значения:
- `SUCCESS` - объединение прошло успешно;
- `CONFLICT` - при объединении возник конфликт;
- `ERROR` - при объединении произошла ошибка. Например, если у текущего пользователя нет прав на изменение или удаление записей. ||
|| **ENTITY_IDS**
| Содержит идентификаторы элементов, которые были объединены, кроме идентификатора элемента, оставшегося после объединения. ||
|#

## Пример вызова:

```js
BX24.callMethod(
    'crm.entity.mergeBatch',
    {
        params: {
            entityTypeId: 3,
            entityIds: [1, 2, 3],
        }
    },
    (result) => {
        console.log(result);
    }
);
```

## Ручное объединение для случаев, когда возник конфликт

Для продолжения объединения вручную, в привычном пользователю интерфейсе **Битиркс24**, достаточно перенаправить его в раздел ручного объединения по соответствующей ссылке:

- Контакты: `/crm/contact/merge/?id=1,2,3`
- Компании: `/crm/company/merge/?id=1,2,3`
- Лиды: `/crm/lead/merge/?id=1,2,3`
- Сделки: `/crm/deal/merge/?id=1,2,3`

где параметр `id` содержит указанные через запятую идентификаторы объединяемых записей.

{% include [Сноска о примерах](../../../_includes/examples.md) %}
