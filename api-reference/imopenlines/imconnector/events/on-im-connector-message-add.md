# При получении новых сообщений OnImConnectorMessageAdd

{% note warning "Мы еще обновляем эту страницу" %}

Тут может не хватать некоторых данных — дополним в ближайшее время

{% endnote %}

{% if build == 'dev' %}

{% note alert "TO-DO _не выгружается на prod_" %}

- проверить ссылку на CHAT_API
- не указаны типы и обязательность параметров
- 
{% endnote %}

{% endif %}

> Scope: [`imopenlines`](../../../scopes/permissions.md)
>
> Кто может подписаться: любой пользователь

Событие отмечает новое сообщение из ОЛ. Событие выбрасывается для полноценных коннекторов, таких как Телеграм или ВКонтакте. Оно не работает с [виджетом или онлайн чатом](*ключ_виджет), которые скорее js-приложения. 

Обязательно нужно вызвать в ответ метод [**imconnector.send.status.delivery**](../imconnector-send-status-delivery.md), иначе в мессенджере сообщение будет значиться как недоставленное.

{% note info "" %}

События не будут отправляться в приложение, пока установка не завершена. [Проверьте установку приложения](../../../../settings/app-installation/installation-finish.md)

{% endnote %}

## Параметры

#|
|| **Параметр** | **Описание** | **С версии** ||
|| **CONNECTOR** | ID коннектора (по нему проводится проверка, относится ли это событие к проверяющему). | ||
|| **LINE** | ID открытой линии. | ||
|| **MESSAGES** | Массив сообщений, где каждое сообщение описывается массивом следующего вида:


```json
{
"im": {
    "chat_id": 845,
    "message_id": 344029
},
"message": {
    "text": "Сергей \"Покоев\":\n Тестовое сообщение"
},
"chat": {
    "id": "2"
}
}
```
| ||
|#

{% include [Сноска о параметрах](../../../../_includes/required.md) %}

[*ключ_виджет]: Смотрите документацию по CHAT API. [Подробнее...](../../../chats/index.md)