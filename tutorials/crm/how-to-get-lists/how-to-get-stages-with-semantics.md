# –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–¥–∏–π c —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ CRM

> Scope: [`crm, user_brief`](../../../api-reference/scopes/permissions.md)
>
> –ö—Ç–æ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–µ—Ç–æ–¥: –ª—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ CRM

–°–µ–º–∞–Ω—Ç–∏–∫–∞ —Å—Ç–∞–¥–∏–∏ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ CRM: –≤ —Ä–∞–±–æ—Ç–µ, —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω –∏–ª–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–º–∞–Ω—Ç–∏–∫–∏ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –æ—Ç—á–µ—Ç–æ–≤.

–ß—Ç–æ–±—ã —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å—Ç–∞–¥–∏–π –æ–±—ä–µ–∫—Ç–∞ CRM —Å —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ [crm.status.list](../../../api-reference/crm/status/crm-status-list.md).

## –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–¥–∏–π —Å —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π

–ú–µ—Ç–æ–¥ [crm.status.list](../../../api-reference/crm/status/crm-status-list.md) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞–¥–∏–π –ø–æ –∫–æ–¥—É —Å—Ç–∞–¥–∏–π `ENTITY_ID` –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ CRM.

-  [–°–¥–µ–ª–∫–∏](../../../api-reference/crm/deals/index.md) ‚Äî `DEAL_STAGE` –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–¥–µ–ª–æ–∫ –∏ `DEAL_STAGE_xx`  –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ, –≥–¥–µ xx ‚Äî —ç—Ç–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

-  [–õ–∏–¥—ã](../../../api-reference/crm/leads/index.md) ‚Äî  `STATUS`.

-  [–°—á–µ—Ç–∞](../../../api-reference/crm/universal/invoice.md) ‚Äî `SMART_INVOICE_STAGE_xx`, –≥–¥–µ `xx` ‚Äî  –∑–Ω–∞—á–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–æ–≤.

-  [–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è](../../../api-reference/crm/quote/index.md) ‚Äî `QUOTE_STATUS`.

-  [–î–æ–∫—É–º–µ–Ω—Ç—ã](https://helpdesk.bitrix24.ru/open/17572968/) ‚Äî `SMART_DOCUMENT_STAGE_xx`, –≥–¥–µ `xx` ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ `ID` –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

-  [–°–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å—ã](../../../api-reference/crm/universal/index.md) ‚Äî  `DYNAMIC_xx_STAGE_xx`, –≥–¥–µ –ø–µ—Ä–≤—ã–π `xx` ‚Äî —ç—Ç–æ `ID` —Å–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∞, –≤—Ç–æ—Ä–æ–π `xx` ‚Äî —ç—Ç–æ `ID` –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

–ü–æ–ª—É—á–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞–¥–∏–π —Å —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π –¥–ª—è –ª–∏–¥–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ —É–∫–∞–∂–µ–º –≤ —Ñ–∏–ª—å—Ç—Ä–µ `filter` –ø–æ–ª–µ `ENTITY_ID` —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `STATUS`.

{% include [–°–Ω–æ—Å–∫–∞ –æ –ø—Ä–∏–º–µ—Ä–∞—Ö](../../../_includes/examples.md) %}

{% list tabs %}

-  JS

    ```javascript
    BX24.callMethod(
        "crm.status.list",
        {
            order: { SORT: "ASC" }, // —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø–æ–ª–µ SORT
            filter: { ENTITY_ID: "STATUS" }, // –ø–æ–ª—É—á–∏–º —Å—Ç–∞–¥–∏–∏ –¥–ª—è –ª–∏–¥–æ–≤
        },
        function(result) {
            if(result.error())
                console.error(result.error());
            else
                console.dir(result.data());
        }
    );
    ```

-  PHP

    ```php
    require_once('crest.php');

    $result = CRest::call(
        'crm.status.list',
        [
            'order' => [ 'SORT' => 'ASC' ],
            'filter' => [ 'ENTITY_ID' => 'STATUS' ]
        ]
    );
    ```

{% endlist %}

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—É—á–∏–º –º–∞—Å—Å–∏–≤ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏, –≥–¥–µ –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç ‚Äî —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞–¥–∏–∏.

```json
{
    "result": [
        {
            "ID": "1",
            "ENTITY_ID": "STATUS",
            "STATUS_ID": "NEW",
            "NAME": "–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω",
            "NAME_INIT": "–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω",
            "SORT": "10",
            "SYSTEM": "Y",
            "CATEGORY_ID": null,
            "COLOR": "#00FFFF",
            "SEMANTICS": null,
            "EXTRA": {
                "SEMANTICS": "process",
                "COLOR": "#00FFFF"
            }
        },
        {
            "ID": "3",
            "ENTITY_ID": "STATUS",
            "STATUS_ID": "ASSIGNED",
            "NAME": "–ù–∞–∑–Ω–∞—á–µ–Ω –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π",
            "NAME_INIT": "",
            "SORT": "20",
            "SYSTEM": "N",
            "CATEGORY_ID": null,
            "COLOR": "#FFF100",
            "SEMANTICS": null,
            "EXTRA": {
                "SEMANTICS": "process",
                "COLOR": "#FFF100"
            }
        },
        ...,
        {
            "ID": "15",
            "ENTITY_ID": "STATUS",
            "STATUS_ID": "CONVERTED",
            "NAME": "–°–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω",
            "NAME_INIT": "–°–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω",
            "SORT": "50",
            "SYSTEM": "Y",
            "CATEGORY_ID": null,
            "COLOR": "#37B44A",
            "SEMANTICS": "S",
            "EXTRA": {
                "SEMANTICS": "success",
                "COLOR": "#37B44A"
            }
        },
        {
            "ID": "17",
            "ENTITY_ID": "STATUS",
            "STATUS_ID": "JUNK",
            "NAME": "–ù–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ª–∏–¥",
            "NAME_INIT": "–ù–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ª–∏–¥",
            "SORT": "60",
            "SYSTEM": "Y",
            "CATEGORY_ID": null,
            "COLOR": "#F54819",
            "SEMANTICS": "F",
            "EXTRA": {
                "SEMANTICS": "failure",
                "COLOR": "#F54819"
            }
        }
    ],
    "total": 6
}
```

–û–±—ä–µ–∫—Ç `EXTRA.SEMANTICS` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–º–∞–Ω—Ç–∏–∫—É —Å—Ç–∞–¥–∏–π. –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

-  `process` ‚Äî —ç–ª–µ–º–µ–Ω—Ç CRM –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–±–æ—Ç–µ,

-  `success` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º CRM –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —É—Å–ø–µ—à–Ω–æ,

-  `failure` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º CRM –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –Ω–µ—É—Å–ø–µ—à–Ω–æ.

## –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

–ö–æ–¥ –≤—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—ã —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç–∞–¥–∏–π –¥–ª—è –ª–∏–¥–æ–≤ –∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.

{% list tabs %}

-  JS

   ```javascript
   /**
    * –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ ENTITY_ID
    * @param {string} entityId ‚Äî –∫–æ–¥ —Å—É—â–Ω–æ—Å—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, 'STATUS' –∏–ª–∏ 'QUOTE_STATUS'
    * @returns {Promise<Array>} ‚Äî –º–∞—Å—Å–∏–≤ –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
    */
   function loadStatuses(entityId) {
       return new Promise((resolve, reject) => {
           BX24.callMethod('crm.status.list', {
               filter: { ENTITY_ID: entityId },
               select: ['STATUS_ID', 'NAME', 'EXTRA'],
               order: { SORT: 'ASC' }
           }, (result) => {
               if (result.error()) {
                   reject(result.error());
                   return;
               }
               resolve(result.data());
           });
       });
   }
   
   /**
    * –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –ø–æ —Å–µ–º–∞–Ω—Ç–∏–∫–µ
    */
   function groupStatusesBySemantics(statuses) {
       const groups = { success: [], process: [], failure: [] };
   
       statuses.forEach(item => {
           const semantics = item.EXTRA?.SEMANTICS || '';
           const name = item.NAME || item.STATUS_ID;
   
           if (semantics === 'success') {
               groups.success.push(name);
           } else if (semantics === 'failure') {
               groups.failure.push(name);
           } else {
               groups.process.push(name);
           }
       });
   
       return groups;
   }
   
   /**
    * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≥—Ä—É–ø–ø—ã –¥–ª—è console.table
    */
   function formatForConsoleTable(groups) {
       const { success, process, failure } = groups;
       const maxLen = Math.max(success.length, process.length, failure.length);
   
       const pad = (arr, len) => [...arr, ...Array(len - arr.length).fill('')];
   
       return Array(maxLen).fill().map((_, i) => ({
           '‚úÖ –£—Å–ø–µ—Ö': pad(success, maxLen)[i],
           '‚ö†Ô∏è –í —Ä–∞–±–æ—Ç–µ': pad(process, maxLen)[i],
           '‚ùå –ù–µ—É—Å–ø–µ—Ö': pad(failure, maxLen)[i]
       }));
   }
   
   // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å—ã
   Promise.all([
       loadStatuses('STATUS').then(data => ({ type: '–õ–∏–¥—ã', data })),
       loadStatuses('QUOTE_STATUS').then(data => ({ type: '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è', data }))
   ]).then(results => {
       results.forEach(({ type, data }) => {
           console.group(`üìä ${type}`);
           const groups = groupStatusesBySemantics(data);
           console.table(formatForConsoleTable(groups));
           console.groupEnd();
       });
   }).catch(err => {
       console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', err);
   });
   ```

-  PHP

   ```php
   <?php
   require_once 'crest.php';
   
   /**
    * –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ ENTITY_ID
    * @param string $entityId
    * @return array
    */
   function loadStatuses($entityId) {
       $result = CRest::call('crm.status.list', [
           'filter' => ['ENTITY_ID' => $entityId],
           'select' => ['STATUS_ID', 'NAME', 'EXTRA'],
           'order'  => ['SORT' => 'ASC']
       ]);
   
       if (!empty($result['error'])) {
           throw new Exception("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞—Ç—É—Å–æ–≤ $entityId: " . $result['error_description']);
       }
   
       return $result['result'];
   }
   
   /**
    * –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –ø–æ —Å–µ–º–∞–Ω—Ç–∏–∫–µ
    */
   function groupStatusesBySemantics($statuses) {
       $groups = ['success' => [], 'process' => [], 'failure' => []];
   
       foreach ($statuses as $item) {
           $semantics = $item['EXTRA']['SEMANTICS'] ?? '';
           $name = $item['NAME'] ?? $item['STATUS_ID'];
   
           if ($semantics === 'success') {
               $groups['success'][] = $name;
           } elseif ($semantics === 'failure') {
               $groups['failure'][] = $name;
           } else {
               $groups['process'][] = $name;
           }
       }
   
       return $groups;
   }
   
   /**
    * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
    */
   function buildTableRows($groups) {
       $success = $groups['success'];
       $process = $groups['process'];
       $failure = $groups['failure'];
       $max = max(count($success), count($process), count($failure));
   
       $success = array_pad($success, $max, '');
       $process = array_pad($process, $max, '');
       $failure = array_pad($failure, $max, '');
   
       $rows = [];
       for ($i = 0; $i < $max; $i++) {
           $rows[] = [
               htmlspecialchars($success[$i]),
               htmlspecialchars($process[$i]),
               htmlspecialchars($failure[$i])
           ];
       }
       return $rows;
   }
   
   $entities = [
       ['title' => '–°—Ç–∞—Ç—É—Å—ã –ª–∏–¥–æ–≤', 'entityId' => 'STATUS'],
       ['title' => '–°—Ç–∞—Ç—É—Å—ã –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π', 'entityId' => 'QUOTE_STATUS']
   ];
   
   foreach ($entities as $entity) {
       try {
           $statuses = loadStatuses($entity['entityId']);
           if (empty($statuses)) {
               echo "<p>–ù–µ—Ç —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–ª—è " . htmlspecialchars($entity['title']) . "</p>\n";
               continue;
           }
   
           $groups = groupStatusesBySemantics($statuses);
           $rows = buildTableRows($groups);
   
           echo "<h2>" . htmlspecialchars($entity['title']) . "</h2>\n";
           echo "<table border=\"1\" style=\"border-collapse: collapse; width: 100%;\">\n";
           echo "<thead><tr>
               <th style=\"padding: 8px; background: #d4edda;\">‚úÖ –£—Å–ø–µ—Ö</th>
               <th style=\"padding: 8px; background: #fff3cd;\">‚ö†Ô∏è –í —Ä–∞–±–æ—Ç–µ</th>
               <th style=\"padding: 8px; background: #f8d7da;\">‚ùå –ù–µ—É—Å–ø–µ—Ö</th>
           </tr></thead>\n<tbody>";
   
           foreach ($rows as $row) {
               echo "<tr>
                   <td style=\"padding: 6px;\">{$row[0]}</td>
                   <td style=\"padding: 6px;\">{$row[1]}</td>
                   <td style=\"padding: 6px;\">{$row[2]}</td>
               </tr>\n";
           }
   
           echo "</tbody></table><br>\n";
   
       } catch (Exception $e) {
           echo "<p style=\"color: red;\">–û—à–∏–±–∫–∞: " . htmlspecialchars($e->getMessage()) . "</p>\n";
       }
   }
   ```

{% endlist %}